<% if @response && @response[0] %>
	<% @data = @response[0] %>
	var id = $("#extract-controls #id_content").val();
	console.log("A");
	var group_entity = $("#extract-controls").find("div.group-entity").first();
	console.log("B");
	if (group_entity.hasClass("update")) {
		console.log("updating");
		$("#extract-controls").html('<%= escape_javascript(raw render partial: "geo_viz/extracts/annotation/controls/edit") %>');
	} else {
		console.log("not updating");
		$("#extract-controls").html('<%= escape_javascript(raw render partial: "geo_viz/extracts/annotation/controls/new") %>');
	}
	setExtractControls(<%= @response[0].to_json.html_safe %>);
	$("#extract-controls #id_content").val(id);
	clearMapMarkers();
	addMarkerToMap(<%= @marker.to_json.html_safe %>);
	<% if @response.count > 1 %>
		$("#alternatives").html("<%= escape_javascript(raw render partial: "/geo_viz/placenames/alternatives", layout: false) %>");
		var nameParent = $("#extract-controls #name_content").parent();
		if ($(nameParent).find(".btn").length == 0) {
			$(nameParent).append('<%= link_to content_tag(:span, "", class: "glyphicon glyphicon-globe"), "#alternatives", :class => "btn btn-xs input-group-addon", "data-toggle" => "modal" %>');
		}
	<% end %>
<% end %>
